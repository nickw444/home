esphome:
  name: vacuum-door
  friendly_name: Vacuum Door

esp32:
  board: esp32dev
  framework:
    type: esp-idf

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: !secret vacuum_door_api_encryption_key

ota:
  - platform: esphome
    password: !secret vacuum_door_ota_password

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: "Vacuum-Door Fallback Hotspot"
    password: !secret wifi_fallback_password

captive_portal:

servo:
  - id: servo1
    output: servo_pwm1
    idle_level: 10%
    max_level: 97%
    transition_length: 5s
    auto_detach_time: 10s

output:
  - platform: ledc
    #pin: GPIO12
    pin: GPIO26
    id: servo_pwm1
    frequency: 333.33hz

cover:
  - platform: template
    name: "Osmo Door"
    open_action:
      - servo.write:
          id: servo1
          level: .40
    close_action:
      - servo.write:
          id: servo1
          level: -.50
      - delay: 10s
      - servo.detach:
          id: servo1
    optimistic: true

number:        
  - platform: template
    name: Servo Control
    min_value: -100
    max_value: 100
    step: 1
    optimistic: true
    set_action:
      then:
        - servo.write:
            id: servo1
            level: !lambda 'return x / 100.0;'
 